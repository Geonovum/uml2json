{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "$id": "http://example.org/schema/infra.json",
  "$defs": {
    "Address": {
      "$anchor": "Address",
      "type": "object",
      "properties": {
        "street": {
          "type": "string"
        },
        "housenumber": {
          "type": "string"
        },
        "poBox": {
          "type": "string"
        },
        "city": {
          "type": "string"
        },
        "postalCode": {
          "type": "string"
        },
        "country": {
          "type": "string"
        }
      },
      "required": [
        "city",
        "postalCode"
      ]
    },
    "Building": {
      "$anchor": "Building",
      "allOf": [
        {
          "$ref": "http://example.org/schema/infra.json#Building_Core"
        },
        {
          "type": "object",
          "properties": {
            "address": {
              "$ref": "http://example.org/schema/infra.json#Address"
            },
            "type": {
              "$ref": "http://example.org/schema/infra.json#BuildingType"
            }
          },
          "required": [
            "address",
            "type"
          ]
        }
      ]
    },
    "BuildingPart": {
      "$anchor": "BuildingPart",
      "allOf": [
        {
          "$ref": "http://example.org/schema/infra.json#Building_Core"
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "$ref": "http://example.org/schema/infra.json#BuildingPartType"
            },
            "clearanceHeight": {
              "type": "number",
              "unit": "m"
            },
            "extent3d": {
              "$ref": "https://beta.schemas.opengis.net/json-fg/geometry-objects.json#/$defs/Polyhedron"
            },
            "belongsTo": {
              "type": "array",
              "items": {
                "$ref": "https://FIXME/schema_definitions.json#/$defs/LinkObject"
              },
              "uniqueItems": true
            }
          },
          "required": [
            "extent3d",
            "type"
          ]
        }
      ]
    },
    "BuildingPartType": {
      "$anchor": "BuildingPartType",
      "type": "integer",
      "enum": [
        1000,
        2000,
        2100,
        3000,
        9999
      ]
    },
    "BuildingType": {
      "$anchor": "BuildingType",
      "type": "string",
      "enum": [
        "school",
        "residential house",
        "mixed",
        "other"
      ]
    },
    "Building_Core": {
      "$anchor": "Building_Core",
      "type": "object",
      "properties": {
        "dateOfConstruction": {
          "type": "string",
          "format": "date",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
        },
        "extent": {
          "$ref": "https://geojson.org/schema/Polygon.json"
        }
      },
      "required": [
        "dateOfConstruction",
        "extent"
      ]
    },
    "Parcel": {
      "$anchor": "Parcel",
      "type": "object",
      "properties": {
        "area": {
          "type": "number",
          "unit": "m2"
        },
        "extent": {
          "$ref": "https://geojson.org/schema/Polygon.json"
        },
        "hasBuilding": {
          "type": "array",
          "items": {
            "$ref": "https://FIXME/schema_definitions.json#/$defs/LinkObject"
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "https://FIXME/schema_definitions.json#/$defs/LinkObject"
          },
          "uniqueItems": true
        }
      },
      "required": [
        "area",
        "extent",
        "owner"
      ]
    },
    "Person": {
      "$anchor": "Person",
      "type": "object",
      "properties": {
        "firstName": {
          "type": "string"
        },
        "lastName": {
          "type": "string"
        },
        "owns": {
          "type": "array",
          "items": {
            "$ref": "https://FIXME/schema_definitions.json#/$defs/LinkObject"
          },
          "uniqueItems": true
        }
      },
      "required": [
        "firstName",
        "lastName"
      ]
    }
  }
}